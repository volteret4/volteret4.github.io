<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Last.fm Stats - September 2013</title>
    <link rel="icon" type="image/png" href="images/music.png">
    <!-- Umami Analytics -->
    <script defer src="https://cloud.umami.is/script.js" data-website-id="5d84fd6c-0760-4a0c-a2d0-ffabb82179f5"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1e1e2e;
            color: #cdd6f4;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #181825;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: #1e1e2e;
            padding: 20px 30px;
            border-bottom: 2px solid #cba6f7;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 80px;
        }

        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-grow: 1;
        }

        h1 {
            font-size: 1.8em;
            color: #cba6f7;
            margin: 0;
            text-align: center;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .nav-button {
            padding: 8px 16px;
            background: #313244;
            color: #cdd6f4;
            border: 2px solid #45475a;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
        }

        .nav-button:hover {
            border-color: #cba6f7;
            background: #45475a;
            color: #cdd6f4;
        }

        .nav-button.current {
            background: #cba6f7;
            color: #1e1e2e;
            border-color: #cba6f7;
        }

        .user-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #181825;
            color: #1e1e2e;
            border: none;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .user-button:hover {
            background: #b4a3e8;
            transform: scale(1.1);
        }

        .user-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .user-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1e1e2e;
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            border: 2px solid #cba6f7;
        }

        .user-modal-header {
            color: #cba6f7;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .user-modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #cdd6f4;
            font-size: 1.5em;
            cursor: pointer;
            padding: 0;
        }

        .user-modal-close:hover {
            color: #cba6f7;
        }

        .user-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .user-option {
            padding: 12px 20px;
            background: #313244;
            border: 2px solid #45475a;
            border-radius: 8px;
            color: #cdd6f4;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .user-option:hover {
            border-color: #cba6f7;
            background: #45475a;
        }

        .user-option.selected {
            background: #cba6f7;
            color: #1e1e2e;
            border-color: #cba6f7;
        }

        .controls {
            padding: 20px 30px;
            background: #1e1e2e;
            border-bottom: 1px solid #313244;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }

        .control-group {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }

        .control-group label {
            color: #cba6f7;
            font-weight: 600;
        }

        .category-filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .category-filter {
            padding: 8px 16px;
            background: #313244;
            color: #cdd6f4;
            border: 2px solid #45475a;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            font-weight: 600;
        }

        .category-filter:hover {
            border-color: #cba6f7;
            background: #45475a;
        }

        .category-filter.active {
            background: #cba6f7;
            color: #1e1e2e;
            border-color: #cba6f7;
        }

        .period-header {
            background: #1e1e2e;
            padding: 25px 30px;
            border-bottom: 2px solid #cba6f7;
        }

        .period-header h2 {
            color: #cba6f7;
            font-size: 1.5em;
            margin-bottom: 8px;
        }

        .period-info {
            color: #a6adc8;
            font-size: 0.9em;
        }

        .stats-container {
            padding: 30px;
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 25px;
        }

        .category {
            background: #1e1e2e;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #313244;
            display: none;
        }

        .category.visible {
            display: block;
        }

        .category h3 {
            color: #cba6f7;
            font-size: 1.2em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #cba6f7;
        }

        .item {
            padding: 12px;
            margin-bottom: 10px;
            background: #181825;
            border-radius: 8px;
            border-left: 3px solid #45475a;
            transition: all 0.3s;
            cursor: pointer;
        }

        .item:hover {
            transform: translateX(5px);
            border-left-color: #cba6f7;
        }

        .item.highlighted {
            border-left-color: #cba6f7;
            background: #1a1826;
        }

        .item-name {
            font-weight: 600;
            color: #cdd6f4;
            font-size: 1em;
        }

        .item-meta {
            margin-top: 8px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }

        .badge {
            background: #45475a;
            color: #cdd6f4;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .user-badge {
            background: #313244;
            color: #a6adc8;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75em;
            border: 1px solid #45475a;
        }

        .user-badge.highlighted-user {
            background: #cba6f7;
            color: #1e1e2e;
            border-color: #cba6f7;
        }

        .expandable {
            position: relative;
        }

        .expandable::after {
            content: '‚ñº';
            position: absolute;
            right: 12px;
            top: 12px;
            color: #6c7086;
            font-size: 0.8em;
        }

        .expandable.expanded::after {
            content: '‚ñ≤';
        }

        .details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            padding: 0 15px;
            margin-top: 10px;
        }

        .details.expanded {
            max-height: 400px;
            overflow-y: auto;
            border-top: 1px solid #313244;
            padding-top: 15px;
        }

        .detail-section {
            margin-bottom: 15px;
        }

        .detail-title {
            color: #f9e2af;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .detail-list {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .detail-item {
            background: #181825;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            color: #a6adc8;
        }

        .novelty-section {
            margin-bottom: 25px;
        }

        .novelty-section h4 {
            color: #a6e3a1;
            font-size: 1.05em;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #45475a;
        }

        .novelty-subsection {
            margin-bottom: 20px;
        }

        .novelty-subsection h5 {
            color: #f9e2af;
            font-size: 0.95em;
            margin-bottom: 10px;
        }

        .novelty-empty {
            color: #6c7086;
            font-style: italic;
            text-align: center;
            padding: 20px;
        }

        .artists-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1e1e2e;
            border: 2px solid #cba6f7;
            border-radius: 12px;
            padding: 20px;
            max-width: 500px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 999;
        }

        .popup-header {
            color: #cba6f7;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            border-bottom: 1px solid #313244;
            padding-bottom: 10px;
        }

        .popup-close {
            float: right;
            background: none;
            border: none;
            color: #cdd6f4;
            font-size: 1.2em;
            cursor: pointer;
            padding: 0;
            margin-top: -5px;
        }

        .popup-close:hover {
            color: #cba6f7;
        }

        .artist-list {
            list-style: none;
            padding: 0;
        }

        .artist-list li {
            padding: 8px 12px;
            background: #181825;
            margin-bottom: 5px;
            border-radius: 6px;
            border-left: 3px solid #45475a;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #6c7086;
            font-style: italic;
        }

        .last-update {
            text-align: center;
            padding: 20px;
            color: #6c7086;
            font-size: 0.85em;
            border-top: 1px solid #313244;
        }

        @media (max-width: 768px) {
            .categories {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .category-filters {
                justify-content: center;
            }

            .artists-popup {
                max-width: 90%;
                max-height: 80%;
            }

            header {
                flex-direction: column;
                gap: 15px;
            }

            .nav-buttons {
                order: -1;
            }

            .user-button {
                order: 1;
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>üìä RYM Hispano Estad√≠sticas</h1>
                <div class="nav-buttons">
                    <a href="esta-semana.html" class="nav-button">TEMPORALES</a>
                    <a href="index.html#grupo" class="nav-button">GRUPO</a>
                    <a href="index.html#about" class="nav-button">ACERCA DE</a>
                </div>
            </div>
            <button class="user-button" id="userButton">üë§</button>
        </header>

        <!-- Modal de selecci√≥n de usuario -->
        <div class="user-modal" id="userModal">
            <div class="user-modal-content">
                <button class="user-modal-close" id="userModalClose">√ó</button>
                <div class="user-modal-header">Seleccionar Usuario</div>
                <div class="user-options" id="userOptions">
                    <!-- Se llenar√°n din√°micamente -->
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">

                <div class="category-filters">
                    <button class="category-filter active" data-category="artists">Artistas</button><button class="category-filter " data-category="tracks">Canciones</button><button class="category-filter " data-category="albums">√Ålbumes</button><button class="category-filter " data-category="genres">G√©neros</button><button class="category-filter " data-category="labels">Sellos</button><button class="category-filter " data-category="years">A√±os</button><button class="category-filter " data-category="novelties">Novedades</button>
                </div>
            </div>
        </div>

        <div class="period-header">
            <h2>September 2013</h2>
            <p class="period-info">
                <span id="dateRange"></span> |
                <span id="totalScrobbles"></span> scrobbles totales
            </p>
        </div>

        <div class="stats-container">
            <div class="categories" id="categoriesContainer">
                <!-- Se llenar√° din√°micamente -->
            </div>
        </div>

        <div class="last-update">
            Generado: <span id="generatedAt"></span>
        </div>
    </div>

    <script>
        // Usuarios reales del entorno LASTFM_USERS
        const availableUsers = ["alberto_gu", "EliasJ72", "Frikomid", "GabredMared", "Lonsonxd", "Nubis84", "paqueradejere", "Rocky_stereo", "sdecandelario"];
        const stats = {
  "total_scrobbles": 1845,
  "artists": [],
  "tracks": [],
  "albums": [],
  "genres": [
    {
      "name": "electronic",
      "count": 434,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 30,
        "sdecandelario": 404
      },
      "user_artists": {
        "paqueradejere": [
          "Murcof",
          "Pantha du Prince",
          "Kangding Ray",
          "The Black Dog",
          "Vladislav Delay",
          "Byetone",
          "Jaydee",
          "Zomby",
          "Susumu Yokota",
          "Pridon",
          "Golden Girls",
          "Porn Sword Tobacco",
          "The BPA",
          "Proem",
          "Nathan Fake",
          "Lasers"
        ],
        "sdecandelario": [
          "Metronomy",
          "The Cr√ºxshadows",
          "The Knocks",
          "Miike Snow",
          "Two Door Cinema Club",
          "Tasters",
          "Punks Jump Up",
          "Modwheelmood",
          "Mendetz",
          "Phoenix",
          "Scissor Sisters",
          "Hot Chip",
          "Reverend and the Makers",
          "The Postal Service",
          "Thieves Like Us",
          "Hooverphonic",
          "Visage",
          "Kylie Minogue",
          "Mirwais",
          "Lali Puna",
          "SomethingALaMode",
          "School of Seven Bells",
          "I Was a Cub Scout",
          "Yuksek",
          "Telepathe",
          "LCD Soundsystem",
          "Vast",
          "Is Tropical",
          "Xperiment",
          "Poni Hoax",
          "Menomena",
          "Lady Gaga",
          "Justice",
          "The Hundred in the Hands",
          "Goose",
          "The Ting Tings",
          "Holy Ghost!",
          "Peaches",
          "PNAU",
          "The Radio Dept.",
          "alt-J",
          "Kisses",
          "Spector",
          "We Have Band",
          "Pendulum",
          "New Order",
          "deadmau5",
          "Nine Inch Nails",
          "Putilatex",
          "Tiga",
          "The Knife",
          "Rex the Dog",
          "Gypsy & The Cat",
          "Hurts",
          "Nitzer Ebb",
          "Pet Shop Boys",
          "Junior Senior",
          "Lightning Seeds",
          "Slagsm√•lsklubben",
          "The Naked and Famous",
          "MGMT",
          "Martin Solveig",
          "VNV Nation",
          "The Whitest Boy Alive",
          "Jamaica",
          "Matt & Kim",
          "The Sound of Arrows",
          "The Presets",
          "Trust",
          "The xx",
          "Rockets",
          "The Phenomenal Handclap Band",
          "Kraftwerk",
          "Stereolab",
          "Little Boots",
          "Robots in Disguise",
          "Surkin",
          "Soulwax",
          "Starfucker",
          "Zeigeist",
          "Kap Bambino",
          "We Are Terrorists",
          "Young Empires",
          "We Are Standard",
          "Ladytron",
          "Hadouken!",
          "Suuns",
          "Trentem√∏ller",
          "The Bloody Beetroots",
          "The Prodigy",
          "Hundreds",
          "M83",
          "The Chemical Brothers",
          "Infadels",
          "MSTRKRFT",
          "Shitdisco",
          "Peter & the Magician",
          "The Big Pink",
          "Pin Me Down",
          "The Rapture",
          "Parallels",
          "Moby",
          "Patrick Wolf",
          "Midnight Juggernauts",
          "Infected Mushroom",
          "La Roux",
          "Ladyhawke",
          "Marina & the Diamonds",
          "Soft Cell",
          "Zoot Woman",
          "The Faint",
          "L'√Çme Immortelle",
          "Poolside",
          "Vitalic",
          "Icona Pop",
          "R√∂yksopp",
          "The Crystal Method",
          "Le Tigre",
          "Yacht",
          "Radiohead",
          "Pravda",
          "The Teenagers",
          "Shinichi Osawa",
          "Primal Scream",
          "Human Life",
          "Pop Levi",
          "Simian Mobile Disco",
          "Plushgun",
          "The Golden Filter",
          "Klaxons",
          "The Limousines",
          "Passion Pit"
        ]
      },
      "top_artists": [
        "Slagsm√•lsklubben",
        "Rex the Dog",
        "The Teenagers",
        "Vitalic",
        "The Chemical Brothers",
        "L'√Çme Immortelle",
        "Pendulum",
        "M83",
        "R√∂yksopp",
        "The Prodigy"
      ],
      "top_albums": [
        "Slagsm√•lsklubben - Den svenske disco",
        "Rex the Dog - The Rex The Dog Show",
        "Vitalic - Rave Age",
        "L'√Çme Immortelle - Namenlos",
        "The Teenagers - Reality Check",
        "Pendulum - Immersion",
        "Two Door Cinema Club - Tourist History",
        "The Prodigy - The Fat of the Land",
        "We Are Standard - We Are Standard",
        "M83 - Hurry Up, We're Dreaming"
      ]
    },
    {
      "name": "electronica",
      "count": 159,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 21,
        "sdecandelario": 138
      },
      "user_artists": {
        "paqueradejere": [
          "Murcof",
          "Pantha du Prince",
          "The Black Dog",
          "Susumu Yokota",
          "Porn Sword Tobacco",
          "The BPA",
          "Proem",
          "Nathan Fake",
          "Lasers"
        ],
        "sdecandelario": [
          "Kraftwerk",
          "Zoot Woman",
          "Justice",
          "Stereolab",
          "Pony Pony Run Run",
          "Peaches",
          "Surkin",
          "PNAU",
          "The Faint",
          "Poolside",
          "Pendulum",
          "Vitalic",
          "R√∂yksopp",
          "The Crystal Method",
          "Ladytron",
          "Modwheelmood",
          "The Knife",
          "Hot Chip",
          "Trentem√∏ller",
          "The Postal Service",
          "Thieves Like Us",
          "Shinichi Osawa",
          "Hundreds",
          "Hooverphonic",
          "The Prodigy",
          "M83",
          "Mirwais",
          "Junior Senior",
          "The Chemical Brothers",
          "Lali Puna",
          "MSTRKRFT",
          "Simian Mobile Disco",
          "Plushgun",
          "The Whitest Boy Alive",
          "Yuksek",
          "Telepathe",
          "LCD Soundsystem",
          "The Limousines",
          "Moby",
          "Midnight Juggernauts"
        ]
      },
      "top_artists": [
        "Vitalic",
        "The Chemical Brothers",
        "Pendulum",
        "M83",
        "R√∂yksopp",
        "The Prodigy",
        "Lasers",
        "Ladytron",
        "Justice",
        "The Black Dog"
      ],
      "top_albums": [
        "Vitalic - Rave Age",
        "Pendulum - Immersion",
        "The Prodigy - The Fat of the Land",
        "M83 - Hurry Up, We're Dreaming",
        "R√∂yksopp - Junior",
        "The Chemical Brothers - Further",
        "The Chemical Brothers - Brotherhood",
        "The Black Dog - Tranklements",
        "Lasers - Juno",
        "Lasers - Exchange Levels"
      ]
    },
    {
      "name": "dance",
      "count": 114,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 2,
        "sdecandelario": 112
      },
      "user_artists": {
        "paqueradejere": [
          "Golden Girls",
          "Jaydee"
        ],
        "sdecandelario": [
          "Lady Gaga",
          "Justice",
          "The Knocks",
          "Little Boots",
          "Holy Ghost!",
          "PNAU",
          "The Faint",
          "Miike Snow",
          "Poolside",
          "Vitalic",
          "Young Empires",
          "Punks Jump Up",
          "Scissor Sisters",
          "Tiga",
          "Rex the Dog",
          "The Bloody Beetroots",
          "The Prodigy",
          "Kylie Minogue",
          "Junior Senior",
          "The Chemical Brothers",
          "MSTRKRFT",
          "The xx",
          "Simian Mobile Disco",
          "Martin Solveig",
          "Matt & Kim",
          "The Rapture",
          "LCD Soundsystem",
          "La Roux"
        ]
      },
      "top_artists": [
        "Rex the Dog",
        "Vitalic",
        "The Chemical Brothers",
        "The Prodigy",
        "Justice",
        "Tiga",
        "Holy Ghost!",
        "The xx",
        "The Faint",
        "Simian Mobile Disco"
      ],
      "top_albums": [
        "Rex the Dog - The Rex The Dog Show",
        "Vitalic - Rave Age",
        "The Prodigy - The Fat of the Land",
        "Tiga - Sexor Collector's Edition",
        "Holy Ghost! - Static On The Wire",
        "The xx - xx",
        "The Chemical Brothers - Further",
        "The Chemical Brothers - Brotherhood",
        "Justice - Justice",
        "The Faint - The Geeks Were Right"
      ]
    },
    {
      "name": "electro",
      "count": 109,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 1,
        "sdecandelario": 108
      },
      "user_artists": {
        "paqueradejere": [
          "The Consumer"
        ],
        "sdecandelario": [
          "Metronomy",
          "Justice",
          "Pony Pony Run Run",
          "Little Boots",
          "Goose",
          "Holy Ghost!",
          "Surkin",
          "PNAU",
          "Robots in Disguise",
          "Peaches",
          "Vitalic",
          "Zeigeist",
          "Kap Bambino",
          "deadmau5",
          "We Are Terrorists",
          "Punks Jump Up",
          "Pravda",
          "Tiga",
          "Hot Chip",
          "The Knife",
          "Rex the Dog",
          "Shinichi Osawa",
          "Thieves Like Us",
          "The Bloody Beetroots",
          "Nitzer Ebb",
          "Human Life",
          "Mirwais",
          "MSTRKRFT",
          "SomethingALaMode",
          "Simian Mobile Disco",
          "The Golden Filter",
          "Shitdisco",
          "Peter & the Magician",
          "Yuksek",
          "The Presets",
          "Midnight Juggernauts",
          "Poni Hoax"
        ]
      },
      "top_artists": [
        "Rex the Dog",
        "Vitalic",
        "Justice",
        "Poni Hoax",
        "Tiga",
        "Holy Ghost!",
        "Pony Pony Run Run",
        "Hot Chip",
        "Simian Mobile Disco",
        "The Knife"
      ],
      "top_albums": [
        "Rex the Dog - The Rex The Dog Show",
        "Vitalic - Rave Age",
        "Poni Hoax - Images Of Sigrid",
        "Tiga - Sexor Collector's Edition",
        "Holy Ghost! - Static On The Wire",
        "Justice - Justice",
        "Hot Chip - One Life Stand",
        "Mirwais - Clara Sheller (saison 2)",
        "SomethingALaMode - SomethingALaMode",
        "Pony Pony Run Run - You Need Pony Pony Run Run"
      ]
    },
    {
      "name": "techno",
      "count": 77,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 13,
        "sdecandelario": 64
      },
      "user_artists": {
        "paqueradejere": [
          "Pantha du Prince",
          "The Black Dog",
          "Byetone",
          "Jaydee",
          "Golden Girls",
          "Nathan Fake",
          "Remote_"
        ],
        "sdecandelario": [
          "Rex the Dog",
          "The Prodigy",
          "The Crystal Method",
          "The Chemical Brothers",
          "Trentem√∏ller",
          "Vitalic"
        ]
      },
      "top_artists": [
        "Rex the Dog",
        "Vitalic",
        "The Chemical Brothers",
        "The Prodigy",
        "The Black Dog",
        "Byetone",
        "Nathan Fake",
        "Trentem√∏ller",
        "Pantha du Prince",
        "Jaydee"
      ],
      "top_albums": [
        "Rex the Dog - The Rex The Dog Show",
        "Vitalic - Rave Age",
        "The Prodigy - The Fat of the Land",
        "The Chemical Brothers - Further",
        "The Chemical Brothers - Brotherhood",
        "Byetone - Symeta",
        "The Black Dog - Tranklements",
        "The Chemical Brothers - We Are the Night",
        "Vitalic - OK Cowboy",
        "Trentem√∏ller - Moan"
      ]
    },
    {
      "name": "shoegaze",
      "count": 45,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 6,
        "sdecandelario": 39
      },
      "user_artists": {
        "paqueradejere": [
          "Lasers"
        ],
        "sdecandelario": [
          "my bloody valentine",
          "The Pains of Being Pure at Heart",
          "Silversun Pickups",
          "The Big Pink",
          "Mazzy Star",
          "Joy Zipper",
          "The Jesus and Mary Chain",
          "M83",
          "Slowdive",
          "The Raveonettes",
          "The Radio Dept.",
          "Yuck",
          "School of Seven Bells",
          "Les Discrets",
          "Ride"
        ]
      },
      "top_artists": [
        "M83",
        "Lasers",
        "The Jesus and Mary Chain",
        "The Radio Dept.",
        "The Raveonettes",
        "School of Seven Bells",
        "my bloody valentine",
        "The Pains of Being Pure at Heart",
        "Joy Zipper",
        "Slowdive"
      ],
      "top_albums": [
        "M83 - Hurry Up, We're Dreaming",
        "Lasers - Juno",
        "Lasers - Exchange Levels",
        "School of Seven Bells - Disconnect From Desire",
        "my bloody valentine - Loveless",
        "The Radio Dept. - Pet Grief",
        "M83 - Saturdays = Youth",
        "The Raveonettes - Pretty in Black",
        "Joy Zipper - Dig for Fire: A Tribute to Pixies",
        "The Jesus and Mary Chain - The Crow Original Motion Picture Soundtrack"
      ]
    },
    {
      "name": "ambient",
      "count": 33,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 18,
        "sdecandelario": 15
      },
      "user_artists": {
        "paqueradejere": [
          "Murcof",
          "Kangding Ray",
          "The Black Dog",
          "Vladislav Delay",
          "Susumu Yokota",
          "Pridon",
          "Porn Sword Tobacco",
          "Proem",
          "Hauschka",
          "Remote_"
        ],
        "sdecandelario": [
          "Slowdive",
          "Hundreds",
          "Moby",
          "R√∂yksopp"
        ]
      },
      "top_artists": [
        "R√∂yksopp",
        "The Black Dog",
        "Murcof",
        "Hauschka",
        "Moby",
        "Susumu Yokota",
        "Hundreds",
        "Slowdive",
        "Proem",
        "Vladislav Delay"
      ],
      "top_albums": [
        "R√∂yksopp - Junior",
        "The Black Dog - Tranklements",
        "Hauschka - Salon des Amateurs",
        "Hundreds - Let's Write The Streets",
        "Slowdive - Souvlaki",
        "Proem - Socially Inept",
        "Susumu Yokota - Kaleidoscope",
        "Murcof - Utop√¨a",
        "Vladislav Delay - Vantaa",
        "Murcof - La Sangre Iluminada"
      ]
    },
    {
      "name": "experimental",
      "count": 33,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 8,
        "sdecandelario": 25
      },
      "user_artists": {
        "paqueradejere": [
          "Kangding Ray",
          "Porn Sword Tobacco",
          "Byetone",
          "Hauschka"
        ],
        "sdecandelario": [
          "Yeasayer",
          "Metronomy",
          "Sonic Youth",
          "Menomena",
          "Telepathe",
          "The Limousines",
          "Yacht",
          "Neurosis",
          "School of Seven Bells",
          "TV on the Radio",
          "Suuns"
        ]
      },
      "top_artists": [
        "Neurosis",
        "Byetone",
        "Hauschka",
        "School of Seven Bells",
        "Yeasayer",
        "Metronomy",
        "TV on the Radio",
        "Yacht",
        "Kangding Ray",
        "Porn Sword Tobacco"
      ],
      "top_albums": [
        "Neurosis - Through Silver in Blood",
        "Byetone - Symeta",
        "School of Seven Bells - Disconnect From Desire",
        "Hauschka - Salon des Amateurs",
        "Yeasayer - Odd Blood",
        "Metronomy - Heartbreaker VS Holiday",
        "Hauschka - Ferndorf",
        "Kangding Ray - Stabil",
        "Porn Sword Tobacco - Everything Is Music to the Ear",
        "The Limousines - Very Busy People"
      ]
    }
  ],
  "labels": [
    {
      "name": "4AD",
      "count": 9,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 1,
        "sdecandelario": 8
      },
      "user_artists": {
        "paqueradejere": [
          "Zomby"
        ],
        "sdecandelario": [
          "The Big Pink",
          "Deerhunter",
          "The National",
          "TV on the Radio",
          "Pixies"
        ]
      },
      "top_artists": [
        "Pixies",
        "Deerhunter",
        "TV on the Radio",
        "Zomby",
        "The Big Pink",
        "The National"
      ],
      "top_albums": [
        "Zomby - Dedication",
        "Pixies - Here Comes Your Man",
        "Deerhunter - Halcyon Digest",
        "The Big Pink - A Brief History of Love",
        "TV on the Radio - Return to Cookie Mountain",
        "Pixies - Wave Of Mutilation: Best Of Pixies",
        "TV on the Radio - Dear Science,",
        "Deerhunter - Memory Boy",
        "The National - High Violet"
      ]
    }
  ],
  "years": [
    {
      "name": "2009",
      "count": 86,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 6,
        "sdecandelario": 80
      },
      "user_artists": {
        "paqueradejere": [
          "The BPA",
          "Porn Sword Tobacco",
          "Frank Bretschneider"
        ],
        "sdecandelario": [
          "The Sounds",
          "Ida Maria",
          "Pony Pony Run Run",
          "Pearl Jam",
          "Oh No Ono",
          "Mando Diao",
          "Throw Me The Statue",
          "Vitalic",
          "Calvin Harris",
          "deadmau5",
          "Glasvegas",
          "Gomez",
          "Yacht",
          "Delphic",
          "Cinnamon Chasers",
          "The Ettes",
          "Powerwolf",
          "Love of Lesbian",
          "Mickey Gang",
          "Metric",
          "Bear in Heaven",
          "Dead Man's Bones",
          "The Whitest Boy Alive",
          "The Temper Trap",
          "Boy Crisis",
          "The Big Pink",
          "Telepathe",
          "Matt & Kim",
          "Fever Ray",
          "Strike Anywhere"
        ]
      },
      "top_artists": [
        "Love of Lesbian",
        "Strike Anywhere",
        "Frank Bretschneider",
        "Oh No Ono",
        "Cinnamon Chasers",
        "The Ettes",
        "Delphic",
        "Dead Man's Bones",
        "deadmau5",
        "Gomez"
      ],
      "top_albums": [
        "Love of Lesbian - 1999",
        "Strike Anywhere - Iron Front",
        "Frank Bretschneider - Balance",
        "Oh No Ono - Eggs",
        "Cinnamon Chasers - A Million Miles from Home",
        "The Ettes - Do You Want Power",
        "Delphic - Doubt",
        "Dead Man's Bones - Dead Man's Bones",
        "deadmau5 - I Remember",
        "Gomez - A New Tide"
      ]
    },
    {
      "name": "2007",
      "count": 66,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 1,
        "sdecandelario": 65
      },
      "user_artists": {
        "paqueradejere": [
          "Murcof"
        ],
        "sdecandelario": [
          "The Fratellis",
          "Menomena",
          "Joy Zipper",
          "Danzig",
          "Bat for Lashes",
          "Editors",
          "Blonde Redhead",
          "Familjen",
          "Bloc Party",
          "U.N.P.O.C.",
          "1990s",
          "Parkway Drive",
          "Black Strobe",
          "Etienne de Cr√©cy",
          "The Knife",
          "Client",
          "Kylie Minogue",
          "The Killers",
          "La Polla Records",
          "Arctic Monkeys",
          "Daft Punk",
          "Death in June",
          "of Montreal",
          "High Five Drive",
          "Midnight Juggernauts",
          "Dave Gahan"
        ]
      },
      "top_artists": [
        "Bloc Party",
        "High Five Drive",
        "The Killers",
        "Editors",
        "Death in June",
        "Joy Zipper",
        "Etienne de Cr√©cy",
        "Client",
        "Murcof",
        "Arctic Monkeys"
      ],
      "top_albums": [
        "Bloc Party - A Weekend In the City",
        "High Five Drive - From the Ground Up",
        "The Killers - Hot Fuss",
        "Editors - An End Has a Start",
        "Death in June - Brown Book",
        "Joy Zipper - Dig for Fire: A Tribute to Pixies",
        "Etienne de Cr√©cy - Commercial Ep 2",
        "Client - Heartland",
        "Murcof - Cosmos",
        "Arctic Monkeys - Favourite Worst Nightmare"
      ]
    },
    {
      "name": "2012",
      "count": 63,
      "users": [
        "sdecandelario",
        "Frikomid",
        "paqueradejere"
      ],
      "user_counts": {
        "Frikomid": 2,
        "paqueradejere": 10,
        "sdecandelario": 51
      },
      "user_artists": {
        "Frikomid": [
          "Godspeed You! Black Emperor"
        ],
        "paqueradejere": [
          "Ametsub"
        ],
        "sdecandelario": [
          "Icona Pop",
          "Converge",
          "The Killers",
          "Django Django",
          "Kylesa",
          "Moby",
          "The Courteeners",
          "The Black Keys",
          "Spector",
          "Ash",
          "Infected Mushroom",
          "alt-J",
          "Animal Collective"
        ]
      },
      "top_artists": [
        "Converge",
        "Kylesa",
        "Ametsub",
        "Icona Pop",
        "Django Django",
        "Spector",
        "Godspeed You! Black Emperor",
        "Infected Mushroom",
        "The Killers",
        "Ash"
      ],
      "top_albums": [
        "Converge - All We Love We Leave Behind [Deluxe Edition]",
        "Kylesa - From the Vaults, Vol. 1",
        "Ametsub - All Is Silence",
        "Icona Pop - I Love It",
        "Django Django - Django Django",
        "Spector - Enjoy It While It Lasts",
        "Godspeed You! Black Emperor - Allelujah! Don't Bend! Ascend!",
        "Infected Mushroom - Army of Mushrooms",
        "The Killers - Battle Born",
        "Ash - A-Z"
      ]
    },
    {
      "name": "2008",
      "count": 52,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 4,
        "sdecandelario": 48
      },
      "user_artists": {
        "paqueradejere": [
          "Pridon",
          "Basic Channel",
          "Hauschka",
          "Remote_"
        ],
        "sdecandelario": [
          "Metronomy",
          "Justice",
          "Little Boots",
          "Lori Meyers",
          "Editors",
          "Pete and the Pirates",
          "Grafton Primary",
          "Jimmy Eat World",
          "Pendulum",
          "We Are Terrorists",
          "Beach House",
          "The Cardigans",
          "Putilatex",
          "R.E.M.",
          "Eagles of Death Metal",
          "Does It Offend You, Yeah?",
          "The Bloody Beetroots",
          "The 69 Eyes",
          "Mirwais",
          "The Chemical Brothers",
          "MSTRKRFT",
          "Korn",
          "These New Puritans",
          "The Kills",
          "The Presets",
          "Crystal Castles",
          "Flowers Forever",
          "FM Belfast",
          "Passion Pit"
        ]
      },
      "top_artists": [
        "Editors",
        "The Cardigans",
        "The Chemical Brothers",
        "Does It Offend You, Yeah?",
        "Putilatex",
        "Mirwais",
        "Pete and the Pirates",
        "The Kills",
        "Metronomy",
        "Jimmy Eat World"
      ],
      "top_albums": [
        "Editors - Bones",
        "The Cardigans - Best Of",
        "The Chemical Brothers - Brotherhood",
        "Putilatex - Domund",
        "Mirwais - Clara Sheller (saison 2)",
        "Pete and the Pirates - Give Me Some Rock'n'roll",
        "Does It Offend You, Yeah? - Epic Last Song",
        "The Kills - Cheap and Cheerful Remixes",
        "Metronomy - Heartbreaker VS Holiday",
        "Jimmy Eat World - Bleed American"
      ]
    },
    {
      "name": "2010",
      "count": 46,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 1,
        "sdecandelario": 45
      },
      "user_artists": {
        "paqueradejere": [
          "Alva Noto"
        ],
        "sdecandelario": [
          "The Pains of Being Pure at Heart",
          "The Knocks",
          "The Ting Tings",
          "Violens",
          "Blood Red Shoes",
          "Volbeat",
          "Delphic",
          "The National",
          "Four Year Strong",
          "Bon Jovi",
          "Enter Shikari",
          "Hurts",
          "Estereotypo",
          "Metric",
          "Folkstone",
          "Deerhunter",
          "The Chemical Brothers",
          "School of Seven Bells",
          "MGMT",
          "Jamaica",
          "The Temper Trap",
          "Supersubmarina",
          "Vampire Weekend",
          "of Montreal"
        ]
      },
      "top_artists": [
        "Blood Red Shoes",
        "The Chemical Brothers",
        "School of Seven Bells",
        "Folkstone",
        "Four Year Strong",
        "Violens",
        "Delphic",
        "The Temper Trap",
        "of Montreal",
        "Hurts"
      ],
      "top_albums": [
        "Blood Red Shoes - Fire Like This",
        "The Chemical Brothers - Further",
        "School of Seven Bells - Disconnect From Desire",
        "Folkstone - Damnati Ad Metalla",
        "Four Year Strong - Enemy of the World",
        "Violens - Amoral",
        "Delphic - Acolyte",
        "The Temper Trap - Fader",
        "of Montreal - False Priest",
        "Hurts - Happiness"
      ]
    },
    {
      "name": "2011",
      "count": 34,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 2,
        "sdecandelario": 32
      },
      "user_artists": {
        "paqueradejere": [
          "Zomby",
          "Juaninacka"
        ],
        "sdecandelario": [
          "The Strokes",
          "VNV Nation",
          "Glass Candy",
          "Thin Lizzy",
          "Bj√∂rk",
          "Justice",
          "The Rapture",
          "Billy Idol",
          "Cults",
          "Faith No More",
          "M83",
          "Ladytron",
          "The National",
          "Duo Kie",
          "White Lies",
          "Rise Against"
        ]
      },
      "top_artists": [
        "M83",
        "The Strokes",
        "Ladytron",
        "Duo Kie",
        "Glass Candy",
        "Cults",
        "VNV Nation",
        "Juaninacka",
        "Zomby",
        "The National"
      ],
      "top_albums": [
        "M83 - Hurry Up, We're Dreaming",
        "The Strokes - Angles",
        "Duo Kie - DE CEREBRI MORTIS",
        "Ladytron - 604",
        "Ladytron - Best of 00-10",
        "Glass Candy - Beat Box",
        "Cults - Cults",
        "VNV Nation - Automatic",
        "Juaninacka - Hellboyz",
        "Zomby - Dedication"
      ]
    },
    {
      "name": "2006",
      "count": 21,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 2,
        "sdecandelario": 19
      },
      "user_artists": {
        "paqueradejere": [
          "Nathan Fake"
        ],
        "sdecandelario": [
          "The Sounds",
          "The Oohlas",
          "Yeah Yeah Yeahs",
          "The Cure",
          "Goldfrapp",
          "Agalloch",
          "MSTRKRFT",
          "Billy Talent",
          "Muse",
          "And One",
          "Roxette"
        ]
      },
      "top_artists": [
        "The Sounds",
        "The Cure",
        "Yeah Yeah Yeahs",
        "Nathan Fake",
        "And One",
        "Billy Talent",
        "Goldfrapp",
        "Agalloch",
        "MSTRKRFT",
        "Roxette"
      ],
      "top_albums": [
        "The Sounds - Dying to Say This to You",
        "The Cure - Greatest Hits",
        "Yeah Yeah Yeahs - Gold Lion - Nick Zinner Mix",
        "And One - Bodypop",
        "Billy Talent - Billy Talent II",
        "Nathan Fake - At the Controls 1",
        "Nathan Fake - Drowning in a Sea of Love",
        "Goldfrapp - Fly Me Away",
        "Agalloch - Ashes Against the Grain",
        "MSTRKRFT - Easy Love"
      ]
    },
    {
      "name": "2013",
      "count": 19,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 3,
        "sdecandelario": 16
      },
      "user_artists": {
        "paqueradejere": [
          "Lasers"
        ],
        "sdecandelario": [
          "King Kobra",
          "Arctic Monkeys",
          "Coldplay",
          "TV on the Radio",
          "The Sisters of Mercy"
        ]
      },
      "top_artists": [
        "Arctic Monkeys",
        "Lasers",
        "King Kobra",
        "Coldplay",
        "The Sisters of Mercy",
        "TV on the Radio"
      ],
      "top_albums": [
        "Arctic Monkeys - AM",
        "Lasers - Exchange Levels",
        "King Kobra - III",
        "Coldplay - A Rush of Blood to the Head",
        "The Sisters of Mercy - Floodland",
        "TV on the Radio - Dear Science,"
      ]
    },
    {
      "name": "1992",
      "count": 8,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 1,
        "sdecandelario": 7
      },
      "user_artists": {
        "paqueradejere": [
          "Golden Girls"
        ],
        "sdecandelario": [
          "Death in June",
          "Kyuss",
          "Manic Street Preachers",
          "St. Elmo's fire",
          "Extremoduro"
        ]
      },
      "top_artists": [
        "Extremoduro",
        "Kyuss",
        "Golden Girls",
        "Death in June",
        "St. Elmo's fire",
        "Manic Street Preachers"
      ],
      "top_albums": [
        "Extremoduro - Deltoya",
        "Kyuss - Blues for the Red Sun",
        "Golden Girls - In order to dance",
        "Death in June - But, What Ends When the Symbols Shatter?",
        "St. Elmo's fire - Desperate Years",
        "Manic Street Preachers - Generation Terrorists"
      ]
    },
    {
      "name": "2014",
      "count": 5,
      "users": [
        "sdecandelario",
        "paqueradejere"
      ],
      "user_counts": {
        "paqueradejere": 1,
        "sdecandelario": 4
      },
      "user_artists": {
        "paqueradejere": [
          "Cylob"
        ],
        "sdecandelario": [
          "Kyuss",
          "Gorillaz",
          "Martin Solveig"
        ]
      },
      "top_artists": [
        "Gorillaz",
        "Cylob",
        "Kyuss",
        "Martin Solveig"
      ],
      "top_albums": [
        "Gorillaz - Demon Days",
        "Cylob - Bounds Green",
        "Kyuss - ...And the Circus Leaves Town",
        "Martin Solveig - Hello"
      ]
    }
  ],
  "novelties": {
    "nuevos": {
      "artists": [
        {
          "name": "Frank Bretschneider",
          "count": 31,
          "users": [
            "paqueradejere"
          ],
          "first_date": 1378757634
        }
      ],
      "albums": [
        {
          "name": "L'√Çme Immortelle - Namenlos",
          "artist": "L'√Çme Immortelle",
          "album": "Namenlos",
          "count": 13,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1380272317
        },
        {
          "name": "Turbonegro - Scandinavian Leather",
          "artist": "Turbonegro",
          "album": "Scandinavian Leather",
          "count": 13,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1379664395
        },
        {
          "name": "Frank Bretschneider - status",
          "artist": "Frank Bretschneider",
          "album": "status",
          "count": 12,
          "users": [
            "paqueradejere"
          ],
          "first_date": 1379544248
        },
        {
          "name": "H√ºsker D√º - Zen Arcade",
          "artist": "H√ºsker D√º",
          "album": "Zen Arcade",
          "count": 23,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1379345312
        },
        {
          "name": "U2 - The Best of 1980-1990",
          "artist": "U2",
          "album": "The Best of 1980-1990",
          "count": 14,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1378969331
        },
        {
          "name": "Frank Bretschneider - Rhythm",
          "artist": "Frank Bretschneider",
          "album": "Rhythm",
          "count": 15,
          "users": [
            "paqueradejere"
          ],
          "first_date": 1378757634
        }
      ],
      "tracks": [
        {
          "name": "Holy Ghost! - I Know, I Hear",
          "artist": "Holy Ghost!",
          "track": "I Know, I Hear",
          "count": 4,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1379502761
        },
        {
          "name": "Love of Lesbian - Te hiero mucho",
          "artist": "Love of Lesbian",
          "track": "Te hiero mucho",
          "count": 13,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1379014732
        },
        {
          "name": "Zenttric - Solo Quiero Bailar",
          "artist": "Zenttric",
          "track": "Solo Quiero Bailar",
          "count": 6,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1378674558
        },
        {
          "name": "Supersubmarina - XXI",
          "artist": "Supersubmarina",
          "track": "XXI",
          "count": 5,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1378417404
        },
        {
          "name": "Zenttric - S√≥lo Quiero Bailar",
          "artist": "Zenttric",
          "track": "S√≥lo Quiero Bailar",
          "count": 6,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1378417182
        },
        {
          "name": "Rex the Dog - Maximize 2008",
          "artist": "Rex the Dog",
          "track": "Maximize 2008",
          "count": 4,
          "users": [
            "sdecandelario"
          ],
          "first_date": 1378135182
        }
      ]
    },
    "nuevos_compartidos": {
      "artists": [],
      "albums": [],
      "tracks": []
    },
    "nuevos_para_usuario": {
      "artists": [],
      "albums": [],
      "tracks": []
    },
    "nuevos_para_usuarios": {}
  },
  "period_label": "September 2013",
  "from_date": "2013-09-01",
  "to_date": "2013-09-30",
  "generated_at": "2025-11-21 13:27"
};
        const hasNovelties = stats.novelties !== undefined;

        // Funci√≥n para obtener novedades de usuario desde datos precalculados
        function getUserNovelties(user) {
            if (!stats.novelties || !stats.novelties.nuevos_para_usuarios) {
                return { artists: [], albums: [], tracks: [] };
            }

            return stats.novelties.nuevos_para_usuarios[user] || { artists: [], albums: [], tracks: [] };
        }

        // Funcionalidad del bot√≥n de usuario
        function initializeUserSelector() {
            const userButton = document.getElementById('userButton');
            const userModal = document.getElementById('userModal');
            const userModalClose = document.getElementById('userModalClose');
            const userOptions = document.getElementById('userOptions');

            // Cargar usuario guardado desde localStorage
            let selectedUser = localStorage.getItem('lastfm_selected_user') || '';

            // Llenar opciones de usuarios
            availableUsers.forEach(user => {
                const option = document.createElement('div');
                option.className = 'user-option';
                option.dataset.user = user;
                option.textContent = user;
                userOptions.appendChild(option);
            });

            // Marcar opci√≥n seleccionada
            updateSelectedUserOption(selectedUser);

            // Event listeners
            userButton.addEventListener('click', () => {
                userModal.style.display = 'block';
            });

            userModalClose.addEventListener('click', () => {
                userModal.style.display = 'none';
            });

            userModal.addEventListener('click', (e) => {
                if (e.target === userModal) {
                    userModal.style.display = 'none';
                }
            });

            userOptions.addEventListener('click', (e) => {
                if (e.target.classList.contains('user-option')) {
                    const user = e.target.dataset.user;
                    selectedUser = user;

                    // Guardar en localStorage
                    if (user) {
                        localStorage.setItem('lastfm_selected_user', user);
                    } else {
                        localStorage.removeItem('lastfm_selected_user');
                    }

                    updateSelectedUserOption(user);
                    userModal.style.display = 'none';
                    renderStats(); // Re-renderizar con nuevo usuario
                }
            });

            return selectedUser;
        }

        function updateSelectedUserOption(selectedUser) {
            const userOptions = document.getElementById('userOptions');
            userOptions.querySelectorAll('.user-option').forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.user === selectedUser) {
                    option.classList.add('selected');
                }
            });
        }

        // Inicializar categor√≠as activas
        let activeCategories = new Set(['artists']); // Por defecto mostrar artistas
        let selectedUser = '';

        document.getElementById('dateRange').textContent = `${stats.from_date || ''} ‚Üí ${stats.to_date || ''}`;
        document.getElementById('totalScrobbles').textContent = stats.total_scrobbles || 0;
        document.getElementById('generatedAt').textContent = stats.generated_at || '';

        // Manejar filtros de categor√≠as
        const categoryFilters = document.querySelectorAll('.category-filter');
        categoryFilters.forEach(filter => {
            filter.addEventListener('click', () => {
                const category = filter.dataset.category;

                if (activeCategories.has(category)) {
                    activeCategories.delete(category);
                    filter.classList.remove('active');
                } else {
                    activeCategories.add(category);
                    filter.classList.add('active');
                }

                renderStats();
            });
        });

        function showArtistsPopup(itemName, category, user) {
            const item = stats[category].find(item => item.name === itemName);
            if (!item || !item.user_artists || !item.user_artists[user]) return;

            const artists = item.user_artists[user];

            // Crear overlay
            const overlay = document.createElement('div');
            overlay.className = 'popup-overlay';

            // Crear popup
            const popup = document.createElement('div');
            popup.className = 'artists-popup';

            const header = document.createElement('div');
            header.className = 'popup-header';

            const closeBtn = document.createElement('button');
            closeBtn.className = 'popup-close';
            closeBtn.innerHTML = '√ó';
            closeBtn.onclick = () => {
                document.body.removeChild(overlay);
                document.body.removeChild(popup);
            };

            header.innerHTML = `Artistas de ${user} en "${itemName}"`;
            header.appendChild(closeBtn);

            const artistList = document.createElement('ul');
            artistList.className = 'artist-list';

            artists.forEach(artist => {
                const li = document.createElement('li');
                li.textContent = artist;
                artistList.appendChild(li);
            });

            popup.appendChild(header);
            popup.appendChild(artistList);

            // Cerrar al hacer click en overlay
            overlay.onclick = () => {
                document.body.removeChild(overlay);
                document.body.removeChild(popup);
            };

            document.body.appendChild(overlay);
            document.body.appendChild(popup);
        }

        function createNoveltyItem(item, selectedUser) {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'item';

            if (selectedUser && item.users.includes(selectedUser)) {
                itemDiv.classList.add('highlighted');
            }

            const itemName = document.createElement('div');
            itemName.className = 'item-name';
            itemName.textContent = item.name;
            itemDiv.appendChild(itemName);

            const itemMeta = document.createElement('div');
            itemMeta.className = 'item-meta';

            // Conteo de plays si existe
            if (item.count) {
                const countBadge = document.createElement('span');
                countBadge.className = 'badge';
                countBadge.textContent = `${item.count} plays`;
                itemMeta.appendChild(countBadge);
            }

            // Fecha de primer scrobble
            const date = new Date(item.first_date * 1000);
            const dateBadge = document.createElement('span');
            dateBadge.className = 'badge';
            dateBadge.textContent = `Primera vez: ${date.toLocaleDateString('es-ES')}`;
            itemMeta.appendChild(dateBadge);

            // Usuarios que lo han escuchado
            item.users.forEach(user => {
                const userBadge = document.createElement('span');
                userBadge.className = 'user-badge';
                if (user === selectedUser) {
                    userBadge.classList.add('highlighted-user');
                }
                userBadge.textContent = user;
                itemMeta.appendChild(userBadge);
            });

            itemDiv.appendChild(itemMeta);
            return itemDiv;
        }

        function createUserNoveltyItem(item, selectedUser) {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'item';
            itemDiv.classList.add('highlighted'); // Siempre resaltado para el usuario

            const itemName = document.createElement('div');
            itemName.className = 'item-name';
            itemName.textContent = item.name;
            itemDiv.appendChild(itemName);

            const itemMeta = document.createElement('div');
            itemMeta.className = 'item-meta';

            // Total de scrobbles del usuario para este elemento
            if (item.total_count) {
                const totalBadge = document.createElement('span');
                totalBadge.className = 'badge';
                totalBadge.style.background = '#cba6f7';
                totalBadge.style.color = '#1e1e2e';
                totalBadge.textContent = `${item.total_count} total plays`;
                itemMeta.appendChild(totalBadge);
            }

            // Scrobbles en este per√≠odo
            if (item.period_count) {
                const periodBadge = document.createElement('span');
                periodBadge.className = 'badge';
                periodBadge.textContent = `${item.period_count} plays per√≠odo`;
                itemMeta.appendChild(periodBadge);
            }

            // Fecha de primera vez del usuario (si est√° disponible)
            if (item.first_date || item.user_first_date) {
                const date = new Date((item.first_date || item.user_first_date) * 1000);
                const dateBadge = document.createElement('span');
                dateBadge.className = 'badge';
                dateBadge.style.background = '#a6e3a1';
                dateBadge.style.color = '#1e1e2e';
                dateBadge.textContent = `Primera vez: ${date.toLocaleDateString('es-ES')}`;
                itemMeta.appendChild(dateBadge);
            }

            // Usuarios que tambi√©n lo escucharon (coincidencias)
            if (item.coincident_users && item.coincident_users.length > 0) {
                item.coincident_users.forEach(user => {
                    const userBadge = document.createElement('span');
                    userBadge.className = 'user-badge';
                    userBadge.textContent = user;
                    itemMeta.appendChild(userBadge);
                });
            }

            // Informaci√≥n de coincidencias
            if (item.num_coincidences) {
                const coincidencesBadge = document.createElement('span');
                coincidencesBadge.className = 'badge';
                coincidencesBadge.style.background = '#f38ba8';
                coincidencesBadge.style.color = '#1e1e2e';
                coincidencesBadge.textContent = `${item.num_coincidences} coincidencias`;
                itemMeta.appendChild(coincidencesBadge);
            }

            itemDiv.appendChild(itemMeta);
            return itemDiv;
        }

        function renderStats() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';

            const categoryTitles = {
                artists: 'Artistas M√°s Escuchados',
                tracks: 'Canciones M√°s Escuchadas',
                albums: '√Ålbumes M√°s Escuchados',
                genres: 'G√©neros M√°s Escuchados',
                labels: 'Sellos M√°s Escuchados',
                years: 'A√±os M√°s Escuchados',
                novelties: 'Novedades'
            };

            let hasData = false;

            ['artists', 'tracks', 'albums', 'genres', 'labels', 'years', 'novelties'].forEach(categoryKey => {
                if (!activeCategories.has(categoryKey)) return;

                // Manejo especial para novedades
                if (categoryKey === 'novelties') {
                    if (!hasNovelties || !stats.novelties) return;

                    hasData = true;
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'category visible';
                    categoryDiv.dataset.category = categoryKey;

                    const title = document.createElement('h3');
                    title.textContent = categoryTitles[categoryKey];
                    categoryDiv.appendChild(title);

                    // NUEVOS PARA TODOS
                    const nuevosSection = document.createElement('div');
                    nuevosSection.className = 'novelty-section';

                    const nuevosTitle = document.createElement('h4');
                    nuevosTitle.textContent = 'üÜï Nuevos para todos';
                    nuevosSection.appendChild(nuevosTitle);

                    ['artists', 'albums', 'tracks'].forEach(type => {
                        const subsection = document.createElement('div');
                        subsection.className = 'novelty-subsection';

                        const subsectionTitle = document.createElement('h5');
                        subsectionTitle.textContent = type === 'artists' ? 'Artistas' :
                                                     type === 'albums' ? '√Ålbumes' : 'Canciones';
                        subsection.appendChild(subsectionTitle);

                        const items = stats.novelties.nuevos[type];
                        if (items && items.length > 0) {
                            items.forEach(item => {
                                const itemDiv = createNoveltyItem(item, selectedUser);
                                subsection.appendChild(itemDiv);
                            });
                        } else {
                            const emptyDiv = document.createElement('div');
                            emptyDiv.className = 'novelty-empty';
                            emptyDiv.textContent = 'No hay elementos nuevos';
                            subsection.appendChild(emptyDiv);
                        }

                        nuevosSection.appendChild(subsection);
                    });

                    categoryDiv.appendChild(nuevosSection);

                    // NUEVOS COMPARTIDOS
                    const compartidosSection = document.createElement('div');
                    compartidosSection.className = 'novelty-section';

                    const compartidosTitle = document.createElement('h4');
                    compartidosTitle.textContent = 'üë• Nuevos compartidos (50%+ del grupo)';
                    compartidosSection.appendChild(compartidosTitle);

                    ['artists', 'albums', 'tracks'].forEach(type => {
                        const subsection = document.createElement('div');
                        subsection.className = 'novelty-subsection';

                        const subsectionTitle = document.createElement('h5');
                        subsectionTitle.textContent = type === 'artists' ? 'Artistas' :
                                                     type === 'albums' ? '√Ålbumes' : 'Canciones';
                        subsection.appendChild(subsectionTitle);

                        const items = stats.novelties.nuevos_compartidos[type];
                        if (items && items.length > 0) {
                            items.forEach(item => {
                                const itemDiv = createNoveltyItem(item, selectedUser);
                                subsection.appendChild(itemDiv);
                            });
                        } else {
                            const emptyDiv = document.createElement('div');
                            emptyDiv.className = 'novelty-empty';
                            emptyDiv.textContent = 'No hay elementos nuevos compartidos';
                            subsection.appendChild(emptyDiv);
                        }

                        compartidosSection.appendChild(subsection);
                    });

                    // NUEVOS PARA USUARIO SELECCIONADO
                    if (selectedUser) {
                        const usuarioSection = document.createElement('div');
                        usuarioSection.className = 'novelty-section';

                        const usuarioTitle = document.createElement('h4');
                        usuarioTitle.textContent = `üë§ Nuevos para ${selectedUser} (ya conocidos por el grupo)`;
                        usuarioSection.appendChild(usuarioTitle);

                        // Calcular novedades para el usuario
                        const userNovelties = getUserNovelties(selectedUser);

                        ['artists', 'albums', 'tracks'].forEach(type => {
                            const subsection = document.createElement('div');
                            subsection.className = 'novelty-subsection';

                            const subsectionTitle = document.createElement('h5');
                            subsectionTitle.textContent = type === 'artists' ? 'Artistas' :
                                                         type === 'albums' ? '√Ålbumes' : 'Canciones';
                            subsection.appendChild(subsectionTitle);

                            const items = userNovelties[type];
                            if (items && items.length > 0) {
                                items.forEach(item => {
                                    const itemDiv = createUserNoveltyItem(item, selectedUser);
                                    subsection.appendChild(itemDiv);
                                });
                            } else {
                                const emptyDiv = document.createElement('div');
                                emptyDiv.className = 'novelty-empty';
                                const typeText = type === 'artists' ? 'artistas' :
                                               type === 'albums' ? '√°lbumes' : 'canciones';
                                emptyDiv.textContent = items ?
                                    `No hay ${typeText} nuevos para ${selectedUser} con coincidencias en el per√≠odo` :
                                    'Calculando novedades del usuario...';
                                subsection.appendChild(emptyDiv);
                            }

                            usuarioSection.appendChild(subsection);
                        });

                        categoryDiv.appendChild(usuarioSection);
                    } else {
                        const usuarioSection = document.createElement('div');
                        usuarioSection.className = 'novelty-section';

                        const usuarioTitle = document.createElement('h4');
                        usuarioTitle.textContent = 'üë§ Nuevos para usuario espec√≠fico';
                        usuarioSection.appendChild(usuarioTitle);

                        const infoDiv = document.createElement('div');
                        infoDiv.className = 'novelty-empty';
                        infoDiv.textContent = 'Selecciona un usuario para ver sus novedades personales';
                        usuarioSection.appendChild(infoDiv);

                        categoryDiv.appendChild(usuarioSection);
                    }
                    container.appendChild(categoryDiv);
                    return;
                }

                if (!stats[categoryKey] || stats[categoryKey].length === 0) return;

                hasData = true;
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category visible';
                categoryDiv.dataset.category = categoryKey;

                const title = document.createElement('h3');
                title.textContent = categoryTitles[categoryKey];
                categoryDiv.appendChild(title);

                stats[categoryKey].forEach(item => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'item';

                    if (selectedUser && item.users.includes(selectedUser)) {
                        itemDiv.classList.add('highlighted');
                    }

                    // Hacer clickeable si es g√©nero, a√±o o sello y hay usuario seleccionado
                    const isClickableForUser = ['genres', 'labels', 'years'].includes(categoryKey) &&
                                       selectedUser &&
                                       item.users.includes(selectedUser) &&
                                       item.user_artists &&
                                       item.user_artists[selectedUser];

                    // Hacer expandible si tiene informaci√≥n detallada
                    const isExpandable = ['genres', 'labels', 'years'].includes(categoryKey) &&
                                         ((item.top_artists && item.top_artists.length > 0) ||
                                          (item.top_albums && item.top_albums.length > 0));

                    const itemName = document.createElement('div');
                    itemName.className = 'item-name';
                    itemName.textContent = item.name;

                    if (isExpandable) {
                        itemDiv.classList.add('expandable');
                    }

                    itemDiv.appendChild(itemName);

                    const itemMeta = document.createElement('div');
                    itemMeta.className = 'item-meta';

                    const countBadge = document.createElement('span');
                    countBadge.className = 'badge';
                    countBadge.textContent = `${item.count} plays`;
                    itemMeta.appendChild(countBadge);

                    item.users.sort((a, b) => (item.user_counts[b] || 0) - (item.user_counts[a] || 0));

                    item.users.forEach(user => {
                        const userBadge = document.createElement('span');
                        userBadge.className = 'user-badge';
                        if (user === selectedUser) {
                            userBadge.classList.add('highlighted-user');
                        }

                        const userScrobbles = item.user_counts[user] || 0;
                        userBadge.textContent = `${user} (${userScrobbles})`;

                        if (isClickableForUser && user === selectedUser) {
                            userBadge.style.cursor = 'pointer';
                            userBadge.addEventListener('click', (e) => {
                                e.stopPropagation();
                                showArtistsPopup(item.name, categoryKey, user);
                            });
                        }

                        itemMeta.appendChild(userBadge);
                    });

                    itemDiv.appendChild(itemMeta);

                    // Detalles expandibles
                    if (isExpandable) {
                        const detailsDiv = document.createElement('div');
                        detailsDiv.className = 'details';

                        if (item.top_artists && item.top_artists.length > 0) {
                            const artistSection = document.createElement('div');
                            artistSection.className = 'detail-section';

                            const artistTitle = document.createElement('div');
                            artistTitle.className = 'detail-title';
                            artistTitle.textContent = 'Top Artistas:';
                            artistSection.appendChild(artistTitle);

                            const artistList = document.createElement('div');
                            artistList.className = 'detail-list';

                            item.top_artists.slice(0, 10).forEach(artist => {
                                const artistItem = document.createElement('span');
                                artistItem.className = 'detail-item';
                                artistItem.textContent = artist;
                                artistList.appendChild(artistItem);
                            });

                            artistSection.appendChild(artistList);
                            detailsDiv.appendChild(artistSection);
                        }

                        if (item.top_albums && item.top_albums.length > 0) {
                            const albumSection = document.createElement('div');
                            albumSection.className = 'detail-section';

                            const albumTitle = document.createElement('div');
                            albumTitle.className = 'detail-title';
                            albumTitle.textContent = 'Top √Ålbumes:';
                            albumSection.appendChild(albumTitle);

                            const albumList = document.createElement('div');
                            albumList.className = 'detail-list';

                            item.top_albums.slice(0, 10).forEach(album => {
                                const albumItem = document.createElement('span');
                                albumItem.className = 'detail-item';
                                albumItem.textContent = album;
                                albumList.appendChild(albumItem);
                            });

                            albumSection.appendChild(albumList);
                            detailsDiv.appendChild(albumSection);
                        }

                        itemDiv.appendChild(detailsDiv);

                        itemDiv.addEventListener('click', (e) => {
                            if (e.target.classList.contains('user-badge') && e.target.style.cursor === 'pointer') {
                                return;
                            }

                            itemDiv.classList.toggle('expanded');
                            detailsDiv.classList.toggle('expanded');
                        });
                    }

                    categoryDiv.appendChild(itemDiv);
                });

                container.appendChild(categoryDiv);
            });

            if (!hasData) {
                const noDataDiv = document.createElement('div');
                noDataDiv.className = 'no-data';
                noDataDiv.textContent = 'No hay datos para mostrar con los filtros seleccionados.';
                container.appendChild(noDataDiv);
            }
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            selectedUser = initializeUserSelector();
            renderStats();
        });
    </script>
</body>
</html>